version: "1.0"
defaults:
  retention_days: 30
  signing_enabled: true
  log_level: info

policies:
  - id: "aws-cleanup-protection"
    match_methods:
      - "aws:ec2:terminate_instances"
      - "aws:s3:delete_bucket"
      - "aws:iam:delete_*"
    risk_level: "critical"
    action: "stall"
    conditions:
      amount_gt: 10 # Hypothetical protection against deleting too many resources
    redact:
      - "aws_access_key"
      - "aws_secret_key"
      - "session_token"

  - id: "aws-readonly-pass"
    match_methods:
      - "aws:ec2:describe_*"
      - "aws:s3:list_*"
    risk_level: "low"
    action: "allow"
